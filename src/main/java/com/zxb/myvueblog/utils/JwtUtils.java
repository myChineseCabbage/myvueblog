package com.zxb.myvueblog.utils;import io.jsonwebtoken.Claims;import io.jsonwebtoken.Jwts;import io.jsonwebtoken.SignatureAlgorithm;import lombok.Data;import lombok.extern.slf4j.Slf4j;import org.springframework.boot.context.properties.ConfigurationProperties;import org.springframework.stereotype.Component;import java.util.Date;@Slf4j@Component@Data@ConfigurationProperties(prefix = "jwt.config")public class JwtUtils {    private  String secret;    private  long  expire;    private  String header = "Authorization";    /**     * 创建token     * @param userId     * @return     */    public  String generateToken(long userId){        Date nowDate = new Date();        //过期时间        Date expireDate = new Date(nowDate.getTime() +expire*1000);        return  Jwts.builder().setHeaderParam("typ","JWT")                .setSubject(userId+"")                .setIssuedAt(nowDate)                .setExpiration(expireDate)                .signWith(SignatureAlgorithm.HS512,secret)                .compact();    }    /**     * 解析     * @param token     * @return     */    public Claims getClaimsBytoken(String token){        try {            return Jwts.parser()                    .setSigningKey(secret)                    .parseClaimsJws(token)                    .getBody();        }catch (Exception e){            log.debug("validate is token error",e);            return  null;        }    }    /**     * 判断是否超时     * @param expiration     * @return     */    public  boolean isTokenExpired(Date expiration){        return  expiration.before(new Date());    }//    /**//     * 生成jwt//     * @param id//     * @param subject//     * @param roles//     * @return//     *///    public  String createJwt(String id,String subject,String roles){//        long nowMills = System.currentTimeMillis();//        Date date = new Date(nowMills);//        JwtBuilder builder = Jwts.builder()//                .setId(id)//                .setSubject(subject)//                .setIssuedAt(date)//                .signWith(SignatureAlgorithm.HS256,key)//                .claim("roles",roles);//        if (ttl>0){//            builder.setExpiration(new Date(nowMills+ttl));//        }//        return  builder.compact();//    }////    /**//     * 解析jwt//     * @param jetStr//     * @return//     *///    public Claims parseJwt(String jetStr){//        return  Jwts.parser().setSigningKey(key).parseClaimsJws(jetStr).getBody();//    }////    public  static  void main(String[] args){////        JwtUtils jwtUtils = new JwtUtils();////        String token = jwtUtils.createJwt("1","daad","admin");//        System.out.println("生成的token为："+token);//        Claims claims = jwtUtils.parseJwt(token);//        System.out.println("解析后的token："+claims);//    }}